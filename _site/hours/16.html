<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞–º–∞ –º—ã –≤—Å–µ —Ç—è–∂–µ–ª–æ –±–æ–ª—å–Ω—ã</title>
    <link rel="stylesheet" href="/assets/styles.css">
    <script>
      document.addEventListener("DOMContentLoaded", function() {
          function redirectToNextHour() {
              const now = new Date();
              const currentHour = now.getHours();
              const nextHour = (currentHour + 1) % 24;

              // –†–∞—Å—Å—á–∏—Ç–∞–µ–º –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —á–∞—Å–∞
              const timeToNextHour = (60 - now.getMinutes()) * 60 * 1000 - now.getSeconds() * 1000;

              // –ü—Ä–æ–≤–µ—Ä–∏–º, —Å–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ —Ç–µ–∫—É—â–∏–π —á–∞—Å —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å —á–∞—Å–æ–º –≤ URL
              const pageHour = parseInt("16:00", 10);
              if (pageHour !== currentHour) {
                  window.location.href = `/hours/${currentHour.toString().padStart(2, '0')}`;
                  return;
              }

              // –£—Å—Ç–∞–Ω–æ–≤–∏–º —Ç–∞–π–º–µ—Ä –¥–ª—è –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —á–∞—Å
              setTimeout(function() {
                  window.location.href = `/hours/${nextHour.toString().padStart(2, '0')}`;
              }, timeToNextHour);
          }

          redirectToNextHour();
      });
  </script>

    <script>
  document.addEventListener("DOMContentLoaded", () => {
      const audioPlayer = document.getElementById("audio-player");
      const playPauseBtn = document.getElementById("play-pause-btn");
      const progressBar = document.querySelector(".progress-bar");
      const currentTimeDisplay = document.getElementById("current-time");
      const durationDisplay = document.getElementById("duration");

      const permalink = "/hours/16";

      // –ü—Ä–æ–±—É–µ–º —Å–Ω–∞—á–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å mp3, –µ—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–±—É–µ–º m4a
      const source = audioPlayer.querySelector("source");

      // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ñ–∞–π–ª–∞ (—á–µ—Ä–µ–∑ fetch)
      const checkFileExists = async (url) => {
          try {
              const response = await fetch(url, { method: "HEAD" });
              return response.ok;
          } catch (error) {
              console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ñ–∞–π–ª–∞:", error);
              return false;
          }
      };

      const trySetSource = async () => {
          // –ü–æ–ø—Ä–æ–±—É–µ–º mp3
          const mp3Url = `/assets/audio${permalink}.mp3`;
          const m4aUrl = `/assets/audio${permalink}.m4a`;

          // –ü—Ä–æ–≤–µ—Ä–∏–º —Å–Ω–∞—á–∞–ª–∞ mp3
          const mp3Exists = await checkFileExists(mp3Url);
          if (mp3Exists) {
              source.src = mp3Url;
          } else {
              // –ï—Å–ª–∏ mp3 –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø—Ä–æ–±—É–µ–º m4a
              const m4aExists = await checkFileExists(m4aUrl);
              if (m4aExists) {
                  source.src = m4aUrl;
              } else {
                  console.error("–§–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.");
                  return;
              }
          }

          audioPlayer.load();
      };

      // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
      trySetSource();

      // –û—Å—Ç–∞–≤—à–∞—è—Å—è —á–∞—Å—Ç—å –∫–æ–¥–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º –æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.
      let autoPlayDisabled = true;
      let isUserInteraction = false;

      audioPlayer.addEventListener("loadedmetadata", () => {
          const currentMinute = new Date().getMinutes();
          const currentSecond = new Date().getSeconds();

          if (currentMinute === 0 && currentSecond < 10) {
              audioPlayer.currentTime = 0;
          } else {
              audioPlayer.currentTime = currentMinute * 60;
          }

          updateProgressBar();
          durationDisplay.textContent = formatTime(audioPlayer.duration);
          attemptAutoPlay();
      });

      function attemptAutoPlay() {
          audioPlayer.play().then(() => {
              console.log("–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω");
              playPauseBtn.classList.remove("paused");
              playPauseBtn.classList.add("playing");
              autoPlayDisabled = false;
          }).catch(error => {
              console.error("–ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω:", error);
              autoPlayDisabled = true;
              enableAutoPlayOnInteraction();
          });
      }

      function enableAutoPlayOnInteraction() {
          const interactionHandler = () => {
              if (autoPlayDisabled) {
                  attemptAutoPlay();
              }
              document.removeEventListener("click", interactionHandler);
              document.removeEventListener("keydown", interactionHandler);
              document.removeEventListener("mousemove", interactionHandler);
              document.removeEventListener("scroll", interactionHandler);
          };

          document.addEventListener("click", interactionHandler);
          document.addEventListener("keydown", interactionHandler);
          document.addEventListener("mousemove", interactionHandler);
          document.addEventListener("scroll", interactionHandler);
      }

      function togglePlayPause() {
          if (audioPlayer.paused) {
              audioPlayer.play().then(() => {
                  playPauseBtn.classList.remove("paused");
                  playPauseBtn.classList.add("playing");
              }).catch(error => {
                  console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏:", error);
              });
          } else {
              audioPlayer.pause();
              playPauseBtn.classList.remove("playing");
              playPauseBtn.classList.add("paused");
          }
      }

      playPauseBtn.addEventListener("click", () => {
          isUserInteraction = true;
          togglePlayPause();
      });

      document.addEventListener("keydown", (event) => {
          if (event.code === "Space") {
              event.preventDefault();
              isUserInteraction = true;
              togglePlayPause();
          }
      });

      function updateProgressBar() {
          if (audioPlayer.duration) {
              const progressPercent = (audioPlayer.currentTime / audioPlayer.duration) * 100;
              progressBar.style.width = `${progressPercent}%`;
              currentTimeDisplay.textContent = formatTime(audioPlayer.currentTime);
          }
      }

      audioPlayer.addEventListener("loadedmetadata", updateProgressBar);
      audioPlayer.addEventListener("timeupdate", updateProgressBar);

      function formatTime(seconds) {
          const mins = Math.floor(seconds / 60);
          const secs = Math.floor(seconds % 60);
          return `${mins}:${secs < 10 ? '0' + secs : secs}`;
      }
  });
  </script>

    <script>
// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏
function updateTime() {
    const footerTimeWrapper = document.getElementById('footer-time-wrapper');
    const now = new Date();
    const hours = now.getHours().toString().padStart(2, '0');
    const minutes = now.getMinutes().toString().padStart(2, '0');
    const seconds = now.getSeconds().toString().padStart(2, '0');

    // –î–æ–±–∞–≤–ª—è–µ–º –∫—Ä—É–∂–æ–∫ –ø–µ—Ä–µ–¥ –≤—Ä–µ–º–µ–Ω–µ–º
    footerTimeWrapper.innerHTML = `${hours}:${minutes}:${seconds}`;
}

// –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
setInterval(updateTime, 1000);
updateTime(); // –ù–∞—á–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ —Å—Ä–∞–∑—É
</script>

    <script>
  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞—Ö –∏ –ª–∞–π–∫–∞—Ö –∏–∑ JSON
  fetch("/data/views.json")
    .then(response => response.json())
    .then(data => {
      const pageKey = "/hours/16"; // –ü–æ–ª—É—á–∞–µ–º URL —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
      const pageData = data[pageKey] || { views: 0, likes: 0 }; // –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ–º 0

      // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –∏ –ª–∞–π–∫–æ–≤
      document.getElementById("view-count").textContent = pageData.views;
      document.getElementById("like-count").textContent = pageData.likes;
    });

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ª–∞–π–∫–æ–≤
  function likePage() {
    const pageKey = "/hours/16"; // –ü–æ–ª—É—á–∞–µ–º URL —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

    // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è –ª–∞–π–∫–æ–≤ (—ç—Ç–æ –º–µ—Å—Ç–æ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)
    fetch(`/update-likes`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ page: pageKey })
    }).then(response => response.json())
      .then(data => {
        document.getElementById("like-count").textContent = data.likes;
      });
  }
</script>

</head>
<body>
  <main>
    <div class="main-content">

<span class="lime-circle">‚óè</span>
<br>
<span id="footer-time-wrapper" class="time-container"></span>
<br>
<span class="highlight-section">–ü—Å–∏—Ö–æ</span>
      <br>
      <h1>–ú–∞–º–∞ –º—ã –≤—Å–µ —Ç—è–∂–µ–ª–æ –±–æ–ª—å–Ω—ã</h1>
      <br>
      <p>
        <span class="highlight-location">–ê–ª–ª–∞ –°–∏–Ω–∏—Ü–∏–Ω–∞</span>
        <span class="highlight-location">–ú–æ—Å–∫–≤–∞</span>
      </p>
      <br>
      <!-- –ê—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π mp3 –∏ m4a -->
<audio id="audio-player" autoplay>
  <source src="/assets/audio//hours/16.mp3" type="audio/mpeg">
  <source src="/assets/audio//hours/16.m4a" type="audio/mp4">
  –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∞—É–¥–∏–æ.
</audio>

<!-- –ö–∞—Å—Ç–æ–º–Ω—ã–π –∞—É–¥–∏–æ-–ø–ª–µ–µ—Ä -->
<div class="custom-audio-player">
  <!-- –ö–Ω–æ–ø–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è -->
  <button id="play-pause-btn" class="paused"></button>

  <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏ —Å–∫—Ä—ã—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ
  <div class="time-display">
    <span id="current-time">0:00</span>
    <span style="color: white;"> / </span>
    <span id="duration">0:00</span>
  </div>
-->
  <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
    <div class="progress-container">
      <div class="progress-bar" id="progress-bar"></div>

  </div>

      <br>
      

      <div>
  –ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤: <span id="view-count">0</span>
</div>
<div>
  –õ–∞–π–∫–æ–≤: <span id="like-count">0</span>
  <button onclick="likePage()">üëç –õ–∞–π–∫</button>
</div>

    </div>
  </main>

  <!-- –§—É—Ç–µ—Ä —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π -->
  <div class="footer-info">
    <div class="rotating-text-container">
      <script>
document.addEventListener("DOMContentLoaded", () => {
  const scheduleItems = document.querySelectorAll(".schedule-item");
  let currentIndex = 0;

  // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
  function showCurrentItem() {
    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏ –¥–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –∞–Ω–∏–º–∞—Ü–∏–∏ –∫ —Ç–µ–∫—É—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É
    scheduleItems.forEach((item, index) => {
      if (index === currentIndex) {
        item.style.display = "flex";
        item.classList.add("fade-in");
      } else {
        item.style.display = "none";
        item.classList.remove("fade-in");
      }
    });

    // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç–ª–µ–º–µ–Ω—Ç—É
    currentIndex = (currentIndex + 1) % scheduleItems.length;
  }

  // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —á–µ—Ä–µ–∑ –∫–∞–∂–¥—ã–µ 5 —Å–µ–∫—É–Ω–¥
  if (scheduleItems.length > 0) {
    showCurrentItem();
    setInterval(showCurrentItem, 5000);
  }
});
</script>

<!-- –°—Ç–∏–ª–∏ –¥–ª—è –ø–ª–∞–≤–Ω–æ–π —Å–º–µ–Ω—ã -->
<style>
.schedule-item {
  display: none;
  opacity: 0;
  transition: opacity 1s ease-in-out;
}

.schedule-item.fade-in {
  opacity: 1;
}
</style>

<!-- –°–ø–∏—Å–æ–∫ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è -->
<div class="rotating-text-container">
  <ul class="schedule-list">
    
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
        <li class="schedule-item">
          <span class="highlight-time">–î–∞–ª–µ–µ</span>
          <span class="highlight-time">20:00</span>
          <span class="highlight-section">–ê–°–ú–†</span>
        </li>
      
    
      
        <li class="schedule-item">
          <span class="highlight-time">–î–∞–ª–µ–µ</span>
          <span class="highlight-time">21:00</span>
          <span class="highlight-section">–ê–°–ú–†</span>
        </li>
      
    
      
        <li class="schedule-item">
          <span class="highlight-time">–î–∞–ª–µ–µ</span>
          <span class="highlight-time">22:00</span>
          <span class="highlight-section">–°—Ç—Ä—É–Ω—ã</span>
        </li>
      
    
      
        <li class="schedule-item">
          <span class="highlight-time">–î–∞–ª–µ–µ</span>
          <span class="highlight-time">23:00</span>
          <span class="highlight-section">–ß–∞—Å –±—ã–∫–∞</span>
        </li>
      
    
  </ul>
</div>

    </div>
    <a href="/donations" target="_blank" class="highlight-donat">$</a>
  </div>
</body>
</html>
